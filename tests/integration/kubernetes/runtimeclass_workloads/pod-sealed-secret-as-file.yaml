# Copyright (c) 2023 Intel Corporation
#
# SPDX-License-Identifier: Apache-2.0
#
apiVersion: v1
kind: Pod
metadata:
  name: secret-test-pod-cc
spec:
  runtimeClassName: kata
  containers:
  - name: busybox
    image: quay.io/prometheus/busybox:latest
    imagePullPolicy: Always
    command:
    - sh
    - -c
    - |
      env
      unseal_data=$(cat /run/sealed-secret-target/secret)
      echo "PROTECTED_SECRET = $unseal_data"
      sleep 1000
    volumeMounts:
        - name: sealed-secret-volume
          mountPath: "/run/sealed-secret-target"
  volumes:
    - name: sealed-secret-volume
      secret:
        secretName: sealed-secret
